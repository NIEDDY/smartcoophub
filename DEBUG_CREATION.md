# Debug Cooperative Creation Issue\n\n## Step 1: Restart Backend with Verbose Logging\n\n```bash\ncd smart-cooperative-hub-be\nnpm run dev\n```\n\nYou should see in the console:\n```\nüöÄ Server running on port 3000\nüìù Environment: development\nüåê API: http://localhost:3000/api\nüíö Health Check: http://localhost:3000/api/health\n```\n\n## Step 2: Create a Test Cooperative\n\nOpen a new terminal and run:\n\n```bash\ncurl -X POST http://localhost:3000/api/cooperatives \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Debug Test Coop\",\n    \"registrationNumber\": \"DBG001\",\n    \"email\": \"debug@test.local\",\n    \"phone\": \"+250788123456\",\n    \"address\": \"Kigali\",\n    \"district\": \"Gasabo\",\n    \"sector\": \"Gacuriro\",\n    \"cell\": \"Cell 1\",\n    \"village\": \"Village 1\",\n    \"type\": \"AGRICULTURAL\"\n  }'\n```\n\n## Step 3: Watch Backend Logs\n\nIn the first terminal (where backend is running), look for these log messages in order:\n\n### Expected Logs (SUCCESS):\n```\nCreating cooperative with data: { name: 'Debug Test Coop', registrationNumber: 'DBG001', ... }\nAbout to create cooperative with data: {...}\n‚úÖ Cooperative CREATED in DB: { id: 'uuid...', name: 'Debug Test Coop', status: 'PENDING', ... }\n‚úÖ‚úÖ VERIFIED: Cooperative exists in database\n```\n\n### If Creation Fails, You'll See:\n```\nCreate cooperative error: [ERROR DETAILS]\n```\n\nNote the error details - this tells us exactly what went wrong.\n\n## Step 4: Check the Response\n\nThe curl command will return JSON. Look for:\n\n### Success Response (201):\n```json\n{\n  \"message\": \"Cooperative created successfully. Awaiting approval.\",\n  \"data\": {\n    \"id\": \"uuid...\",\n    \"name\": \"Debug Test Coop\",\n    \"registrationNumber\": \"DBG001\",\n    \"status\": \"PENDING\",\n    ...\n  }\n}\n```\n\n### Error Response (400 or 500):\n```json\n{\n  \"error\": \"...\",\n  \"details\": \"...\"\n}\n```\n\n## Step 5: Verify in Database\n\nOpen another terminal:\n\n```bash\ncd smart-cooperative-hub-be\nnpx prisma studio\n```\n\nThis opens Prisma Studio in your browser. Navigate to the Cooperative table and look for your record.\n\n## Troubleshooting\n\n### Logs Show \"Creating cooperative with data\" but then nothing\n- Backend crashed or request was interrupted\n- Check for any error messages after the initial log\n- Restart backend and try again\n\n### Logs Show Error Like \"P2002\" or \"Unique constraint failed\"\n- Registration number or email already exists\n- Use a unique registration number (add timestamp)\n- Use a unique email\n\n### Logs Show Error but Data Actually IS in Database\n- Verify step was successful! Data is there.\n- Check Prisma Studio to confirm\n\n### Response is 201 Success but Data Not in Database\n- This indicates a critical issue\n- Check backend logs for \"‚ùå ERROR: Created cooperative not found\"\n- Restart backend and database connection\n\n### Response is 201 and Logs Show ‚úÖ‚úÖ VERIFIED but Frontend Doesn't Show It\n- Data IS in database\n- Frontend not fetching/displaying correctly\n- Check browser console for frontend errors\n\n## Quick Debug Checklist\n\n- [ ] Backend restarted with `npm run dev`\n- [ ] Using valid JWT token\n- [ ] All required fields provided\n- [ ] Watch backend console\n- [ ] Note exact log output\n- [ ] Check response status code\n- [ ] Verify in Prisma Studio\n- [ ] Share log output if stuck\n\n## What Should Happen\n\n1. Request arrives at backend ‚Üí logs \"Creating cooperative with data\"\n2. Validation checks pass ‚Üí continues\n3. Files uploaded (if any) ‚Üí logs \"Logo uploaded\" etc\n4. Prisma create() called ‚Üí logs \"About to create\"\n5. Record inserted in DB ‚Üí logs \"‚úÖ Cooperative CREATED\"\n6. Verification query runs ‚Üí logs \"‚úÖ‚úÖ VERIFIED\"\n7. User updated to COOP_ADMIN ‚Üí completes\n8. Response sent with 201 status ‚Üí client receives data\n\n## If Still Not Working\n\nShare:\n1. Full backend log output (copy-paste what you see)\n2. Response from curl command\n3. What you see in Prisma Studio\n4. Your registration number and email used\n\nWith these details I can pinpoint the exact issue.\n"